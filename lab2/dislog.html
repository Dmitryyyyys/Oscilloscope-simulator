<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Чат с обрезкой</title>
    <style>
        /* Общие стили для страницы */
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
        }

        /* Стили для контейнера чата */
        .chat-container {
            display: none; /* Изначально скрыто, откроется при нажатии на кнопку */
            position: fixed;
            bottom: 0;
            right: 20px;
            width: 300px;
            max-height: 400px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            padding: 10px;
        }

        /* Сообщения чата */
        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .user-message {
            background-color: #d1e7dd;
            align-self: flex-end;
        }

        .bot-message {
            background-color: #f8d7da;
            align-self: flex-start;
        }

        /* Стили для контейнера ввода */
        .input-container {
            display: flex;
            margin-top: 10px;
        }

        input[type="text"] {
            width: calc(100% - 120px);
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        button {
            margin-left: 10px;
            padding: 8px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button.voice-button {
            background-color: #28a745;
        }

        button:hover {
            background-color: #0056b3;
        }

        button.voice-button:hover {
            background-color: #218838;
        }

        /* Стили для кнопки открытия чата */
        #open-chat-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        #open-chat-button:hover {
            background-color: #0056b3;
        }

    </style>
</head>
<body>
    <button id="open-chat-button" onclick="toggleChat()">Открыть чат</button>

    <!-- Контейнер чата -->
    <div class="chat-container" id="chat-container">
        <div class="messages">
            <!-- Сообщения появятся здесь -->
        </div>
        <div class="input-container">
            <input type="text" id="question-input" placeholder="Введите ваш вопрос..." />
            <button onclick="handleQuestion()">Отправить</button>
            <button class="voice-button" onclick="startVoiceInput()">Голос</button>
        </div>
    </div>

    <script>
     
     function toggleChat() {
            const chatContainer = document.getElementById('chat-container');
            if (chatContainer.style.display === 'none' || chatContainer.style.display === '') {
                chatContainer.style.display = 'block';
            } else {
                chatContainer.style.display = 'none';
            }
        }
     var knowledge = [
    ["Закон", "определяет", "зависимость между частотой и длиной волны звуковых волн."],
    ["Амплитуда", "характеризует", "мощность звуковой волны."],
    ["Генератор", "создает", "звуковые волны заданной частоты и амплитуды."],
    ["Частота", "показывает", "количество колебаний в секунду звуковой волны."],
    ["Тембр", "определяет", "характеристику звука, связанную с его качеством."],
    ["Измерение", "осуществляется", "с помощью звуковых датчиков и анализаторов."],
    ["Дифракция", "происходит", "при прохождении звуковых волн через препятствия."],
    ["Акустический сигнал", "моделирует", "распространение звуковых волн в различных средах."],
    ["Интенсивность волны", "определяется", "как квадрат амплитуды звуковой волны."],
    ["Анализ синусоиды", "определяет", "параметры звуковых волн, такие как частота и скорость."],
    ["Зависимость амплитуд", "описывается", "формулой для расчета скорости звука в различных средах."],
    ["Акустическая волна", "изменяется", "в зависимости от температуры воздуха и влажности."],
    ["Температура", "определяет", "скорость распространения звука в воздухе."],
    ["Вакуум", "показывает", "отсутствие распространения звуковых волн."],
    ["Механизм", "обусловлен", "передачей энергии звуковыми волнами через молекулы среды."],
    ["Спектральный сигнал", "позволяет выявить", "характеристики звуковых волн в различных диапазонах."],
    ["Звуковая волна", "показывает", "как интенсивность звука зависит от частоты."],
    ["Симуляция", "моделирует", "распространение звуковых волн через разные среды."],
    ["Измерение", "осуществляется", "с помощью анализаторов звуковых волн и микрофонов."],
    ["Диагностика", "включает", "анализ звуковых волн для проверки качества материалов."],
    ["Метод", "используется", "для определения скорости звука в различных веществах."],
    ["Метод вейхнера", "осуществляется", "путем измерения времени прохождения звуковой волны."],
    ["Звуковая", "позволяет оценить", "концентрацию газа в воздухе через изменение частоты."],
    ["Анализ", "позволяет определить", "характеристики материалов через их реакцию на звуковые волны."],
    ["Датчик", "используется", "для контроля звуковых волн в акустических исследованиях."],
    ["Использование датчиков", "помогает", "студентам понять процессы распространения звуковых волн."],
    ["Проверка", "осуществляется", "с помощью измерений амплитуды и частоты звуковых волн."],
    ["Применение", "используется", "для исследования акустических свойств материалов."],
    ["Измерение звуковых волн", "позволяет", "определить скорость звука в жидкостях и твердых телах."],
    ["Метод", "используется", "для анализа распространения звуковых волн в природе."],
    ["Частота", "используется", "для анализа и исследования звуковых волн."],
    ["Акустика", "позволяет контролировать", "качество звука в музыкальных произведениях."],
    ["Метод", "позволяет", "прогнозировать и анализировать акустические характеристики материалов."],
    ["Волна", "характеризуется", "длиной, частотой и амплитудой."],
    ["Скорость звука", "зависит", "от среды, в которой он распространяется."],
    ["Газовая среда", "позволяет", "звук распространяться с определенной скоростью."],
    ["Акустическая волна", "фокусирует", "энергию звуковых колебаний для создания звука."],
    ["Звуковая плотность", "определяет", "способность материала передавать звуковые волны."],
    ["Частота", "меняется", "в зависимости от среды и источника звука."],
    ["Границы", "создают", "различия в скорости звуковых волн в разных средах."],
    ["Граница", "определяет", "направление и интенсивность звуковых волн."],
    ["Акустика", "изучает", "поведение звуковых волн в различных средах."],
    ["Интерференция", "возникает", "при наложении звуковых волн."],
    ["Дифракция", "характеризует", "изгиб звуковых волн при прохождении через препятствия."],
    ["Абсорбция", "определяет", "способность материала поглощать звуковые волны."],
    ["Эхо", "позволяет", "определить расстояние до объекта через отраженные звуковые волны."],
    ["Звук", "распространяется", "с определенной скоростью в различных средах."],
    ["Поглощение", "зависит", "от частоты и плотности материала."],
    ["Среда", "определяет", "угол отражения и преломления звуковых волн."],
    ["Отражение звука", "возникает", "при переходе звуковых волн между разными средами."],
    ["Акустический спектр", "включает", "частоты, слышимые человеческим ухом."],
    ["Рефракция", "изучает", "изменение направления звуковых волн при переходе через среды."],
    ["Акустическая способность", "зависит", "от состава и плотности материала."],
    ["Анализ волны", "используется", "для определения концентрации звуковых волн в жидкости."],
    ["Измерения амплитуд", "включают", "определение частоты и амплитуды звуковых волн."],
    ["Акустическая сила", "определяет", "интенсивность звуковых волн."],
    ["Преломление", "объясняется", "законом Снеллиуса для звуковых волн."],
    ["Акустический прибор", "используется", "для измерения звуковых волн и их свойств."],
    ["Точка фокуса", "определяется", "параметрами звуковых волн и источником."],
    ["Прозрачность", "характеризует", "способность материала пропускать звуковые волны."],
    ["Материал", "влияет", "на скорость звука в среде."],
    ["Молекулярная структура", "определяет", "передачу звуковых волн через материал."],
    ["Звуковое отражение", "характеризуется", "углом падения звуковых волн на поверхность."],
    ["Химический состав", "влияет", "на акустические свойства вещества."],
    ["Длина волны", "определяет", "частоту звука и его восприятие."],
    ["Фаза", "характеризует", "состояние звуковой волны в заданный момент времени."],
    ["Температурные изменения", "влияют", "на скорость звука в воздухе."],
    ["Водный раствор", "характеризуется", "определенным звуковым сопротивлением."],
    ["Угол падения", "зависит", "от угла, под которым звуковая волна встречает поверхность."],
    ["Акустическая ось", "определяет", "направление распространения звуковых волн."],
    ["Поляризация", "возникает", "при изменении направления звуковых волн."],
    ["Линейная поляризация", "характеризует", "ориентацию звуковых волн в среде."],
    ["Звуковые волны", "имеют", "определенные частоты и амплитуды."],
    ["Использование осциллографа", "предполагает", "подбор материалов с лучшими акустическими свойствами."],
    ///
    ["Источник", "создает", "акустические волны с заданной частотой."],
    ["Длина волны", "влияет", "на распространение звука в среде."],
    ["Акустическая мощность", "характеризует", "интенсивность излучения звука."],
    ["Отражение", "происходит", "при столкновении звуковой волны с преградой."],
    ["Плотность среды", "определяет", "скорость распространения звуковых волн."],
    ["Уровень громкости", "зависит", "от интенсивности звукового сигнала."],
    ["Резонатор", "усиливает", "звуковые волны определенной частоты."],
    ["Акустическая камера", "используется", "для анализа параметров звуковых сигналов."],
    ["Звуковой датчик", "измеряет", "амплитуду и частоту звуковых волн."],
    ["Колебательный процесс", "характеризует", "периодические изменения звуковой среды."],
    ["Эхо-сигнал", "отражается", "от поверхности и возвращается к источнику."],
    ["Преломление звуков", "зависит", "от разности плотностей двух сред."],
    ["Тепловые колебания", "влияют", "на скорость звуковой волны в газах."],
    ["Микрофон", "преобразует", "акустические волны в электрические сигналы."],
    ["Гармонический анализ", "выявляет", "компоненты звукового сигнала."],
    ["Динамик", "излучает", "звуковые колебания в окружающую среду."],
    ["Сила звука", "определяется", "интенсивностью акустической волны."],
    ["Излучатель", "создает", "звуковые волны в воздушной среде."],
    ["Анализатор", "изучает", "спектральные характеристики звука."],
    ["Система", "регулирует", "параметры звука для улучшения качества."],
    ["Точка преломления", "зависит", "от угла падения звуковой волны."],
    ["Акустический барьер", "уменьшает", "распространение звуков в определенной области."],
    ["Громкость", "определяется", "амплитудой звуковых колебаний."],
    ["Акустическая среда", "характеризуется", "плотностью и упругостью вещества."],
    ["Резонанс", "усиливает", "определенные частоты звуковых сигналов."],
    ["Тон", "обусловлен", "частотой звуковой волны."],
    ["Теплопроводность", "влияет", "на поглощение звука в материале."],
    ["Рефлексия", "определяет", "угол возврата звуковой волны."],
    ["Динамическое сопротивление", "влияет", "на амплитуду звуковой волны."],
    ["Энергия звука", "концентрируется", "в области высокой амплитуды."],
    ["Локальная плотность", "влияет", "на скорость звуковой волны в среде."],
    ["Звукопоглощение", "снижается", "при увеличении плотности материала."],
    ["Турбулентность", "нарушает", "распространение звуковой волны в жидкости."],
    ["Фазовая скорость", "показывает", "распространение фазового фронта звуковой волны."],
    ["Компрессия", "усиливает", "колебания в звуковой среде."],
    ["Акустическое давление", "зависит", "от амплитуды волны."],
    ["Сигнальный анализ", "распознает", "характеристики источника звука."],
    ["Параметры среды", "влияют", "на направление распространения звука."],
    ["Угол отражения", "определяется", "параметрами падающей волны."],
    ["Звуковой сигнал", "обрабатывается", "анализатором для изучения его спектра."]    
];
        // Массив псевдоокончаний сказуемых
        var endings = [
            ["ет", "(ет|ут|ют)"], ["ут", "(ет|ут|ют)"], ["ют", "(ет|ут|ют)"],
            ["ит", "(ит|ат|ят)"], ["ат", "(ит|ат|ят)"], ["ят", "(ит|ат|ят)"],
            ["ется", "(ет|ут|ют)ся"], ["утся", "(ет|ут|ют)ся"], ["ются", "(ет|ут|ют)ся"],
            ["ится", "(ит|ат|ят)ся"], ["атся", "(ит|ат|ят)ся"], ["ятся", "(ит|ат|ят)ся"],
            ["ен", "ен"], ["ена", "ена"], ["ено", "ено"], ["ены", "ены"],
            ["ан", "ан"], ["ана", "ана"], ["ано", "ано"], ["аны", "аны"],
            ["жен", "жен"], ["жна", "жна"], ["жно", "жно"], ["жны", "жны"],
            ["такое", "- это"]
        ];

        // Вспомогательная функция для определения сказуемого в вопросе
        function getEnding(word) {
            for (var j = 0; j < endings.length; j++) {
                if (word.substring(word.length - endings[j][0].length) === endings[j][0]) {
                    return j;
                }
            }
            return -1;
        }

        // Функция для преобразования первой буквы в заглавную
        function big(str) {
            return str.substring(0, 1).toUpperCase() + str.substring(1);
        }

        // Функция для преобразования первой буквы в строчную
        function small(str) {
            return str.substring(0, 1).toLowerCase() + str.substring(1);
        }

        // Главная функция для генерации ответа
        function getAnswer(question) {
            var result = false;
            var answer = "";
            var words = question.split(' ').map(small);

            for (var i = 0; i < words.length; i++) {
                var ending = getEnding(words[i]);
                if (ending >= 0) {
                    //замена псевдоокончания на набор возможных окончаний, 
                    //хранящихся во втором столбце массива 

                    words[i] = words[i].substring(0, words[i].length - endings[ending][0].length) + endings[ending][1];
                    var predicate = new RegExp(words[i]);

                    if (endings[ending][0] === endings[ending][1]) {
                        predicate = new RegExp(words[i] + " " + words[i + 1]);
                        i++;
                    }

                    var subject_string = words.slice(i + 1).join(".*");
                    if (subject_string.length > 3) {
                        var subject = new RegExp(".*" + subject_string + ".*");

                        for (var j = 0; j < knowledge.length; j++) {
                            if (predicate.test(small(knowledge[j][1])) && (subject.test(small(knowledge[j][0])) || subject.test(small(knowledge[j][2])))) {
                                answer += big(knowledge[j][0] + " " + knowledge[j][1] + " " + knowledge[j][2] + ". ");
                                result = true;
                            }
                        }
                    }
                }
            }

            if (!result) {
                for (var j = 0; j < knowledge.length; j++) {
                    if (subject && (subject.test(small(knowledge[j][0])) || subject.test(small(knowledge[j][2])))) {
                        answer += big(knowledge[j][0] + " " + knowledge[j][1] + " " + knowledge[j][2] + ". ");
                        result = true;
                    }
                }
            }

            if (!result) answer = "Ответ не найден.";
            return answer.toLowerCase();
        }

        function addMessage(content, type) {
            const chatContainer = document.getElementById('chat-container');
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = content;
            chatContainer.appendChild(message);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function handleQuestion() {
            const input = document.getElementById('question-input');
            const question = input.value.trim();

            if (question) {
                addMessage(question, 'user-message');
                const answer = getAnswer(question);
                addMessage(answer, 'bot-message');
                input.value = '';
                speakAnswer(answer);
            }
        }

        

        // Функция для начала голосового ввода
        function startVoiceInput() {
            var recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'ru-RU'; // Устанавливаем русский язык
            recognition.start();

            recognition.onresult = function(event) {
                var transcript = event.results[0][0].transcript;
                document.getElementById("question-input").value = transcript;
                handleQuestion();
            };

            recognition.onerror = function(event) {
                console.log("Ошибка распознавания речи: ", event.error);
            };
        }

        // Функция для озвучивания ответа
        function speakAnswer(answer) {
            var utterance = new SpeechSynthesisUtterance(answer);
            utterance.lang = 'ru-RU'; // Устанавливаем русский язык для синтеза речи
            window.speechSynthesis.speak(utterance);
            utterance.pitch = 0; // Сделать голос более низким
            utterance.rate = -14;
        }



</script>
    </body>
</html>









